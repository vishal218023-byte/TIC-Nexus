{% extends "base.html" %}

{% block title %}Digital Book Details - TIC Nexus{% endblock %}

{% block extra_css %}
<script src="/static/js/auth-check.js"></script>
{% endblock %}

{% block content %}
<div class="columns is-gapless" style="min-height: 100vh;" x-data="digitalLibraryDetailApp()">
    <!-- Sidebar -->
    {% set active_page = 'digital-library' %}
    {% include 'sidebar.html' %}

    <!-- Main Content -->
    <main class="column" style="background-color: #f8fafc;">
        <div class="section">
            <div class="container is-fluid">
                <!-- Back Button -->
                <div class="mb-4">
                    <a href="/digital-library" class="button is-light">
                        <span class="icon"><i class="fas fa-arrow-left"></i></span>
                        <span>Back to Digital Library</span>
                    </a>
                </div>

                <!-- Loading State -->
                <div x-show="loading" class="has-text-centered py-6">
                    <span class="icon is-large has-text-grey-light">
                        <i class="fas fa-spinner fa-pulse fa-3x"></i>
                    </span>
                    <p class="title is-5 has-text-grey-light mt-4">Loading digital book...</p>
                </div>

                <!-- Error State -->
                <div x-show="error && !loading" class="has-text-centered py-6">
                    <span class="icon is-large has-text-danger">
                        <i class="fas fa-exclamation-circle fa-3x"></i>
                    </span>
                    <p class="title is-4 has-text-grey-dark mt-4">Book Not Found</p>
                    <p class="subtitle is-6 has-text-grey">The digital book you're looking for doesn't exist.</p>
                </div>

                <!-- Main Content - Two Column Layout -->
                <div x-show="!loading && !error" class="columns">
                    <!-- Left Panel - PDF Viewer (60%) -->
                    <div class="column is-7">
                        <div class="box" style="padding: 0; position: relative;">
                            <!-- Full Screen Toggle -->
                            <button @click="toggleFullscreen" class="button is-small is-info" style="position: absolute; top: 10px; right: 10px; z-index: 10;">
                                <span class="icon is-small">
                                    <i class="fas" :class="isFullscreen ? 'fa-compress' : 'fa-expand'"></i>
                                </span>
                            </button>

                            <!-- PDF Viewer -->
                            <div x-show="book && book.file_format === 'pdf'" id="pdf-viewer-container" style="min-height: 600px; background-color: #525659; position: relative;">
                                <iframe 
                                    :src="getPdfViewerUrl()" 
                                    width="100%" 
                                    height="800px"
                                    style="border: none;"
                                    title="PDF Viewer"
                                ></iframe>
                            </div>

                            <!-- Non-PDF Format Message -->
                            <div x-show="book && book.file_format !== 'pdf'" class="has-text-centered" style="padding: 3rem;">
                                <span class="icon is-large has-text-grey-light">
                                    <i class="fas fa-book fa-3x"></i>
                                </span>
                                <p class="title is-5 has-text-grey-dark mt-4" x-text="book ? book.file_format.toUpperCase() + ' Format' : ''"></p>
                                <p class="subtitle is-6 has-text-grey">This format cannot be previewed in the browser.</p>
                                <button @click="downloadBook" class="button is-success is-medium mt-4">
                                    <span class="icon"><i class="fas fa-download"></i></span>
                                    <span>Download to Read</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel - Metadata and Actions (40%) -->
                    <div class="column is-5">
                        <!-- Book Metadata -->
                        <div class="box mb-4">
                            <h3 class="title is-4 has-text-grey-dark mb-3" x-text="book ? book.title : ''"></h3>
                            
                            <div class="content">
                                <table class="table is-fullwidth is-striped">
                                    <tbody>
                                        <tr>
                                            <td style="width: 35%;"><strong>Author</strong></td>
                                            <td x-text="book ? book.author : ''"></td>
                                        </tr>
                                        <tr x-show="book && book.subject">
                                            <td><strong>Subject</strong></td>
                                            <td x-text="book ? book.subject : ''"></td>
                                        </tr>
                                        <tr x-show="book && book.publisher">
                                            <td><strong>Publisher</strong></td>
                                            <td x-text="book ? book.publisher : ''"></td>
                                        </tr>
                                        <tr x-show="book && book.publication_year">
                                            <td><strong>Year</strong></td>
                                            <td x-text="book ? book.publication_year : ''"></td>
                                        </tr>
                                        <tr x-show="book && book.isbn">
                                            <td><strong>ISBN</strong></td>
                                            <td x-text="book ? book.isbn : ''"></td>
                                        </tr>
                                        <tr x-show="book && book.language">
                                            <td><strong>Language</strong></td>
                                            <td x-text="book ? book.language : ''"></td>
                                        </tr>
                                        <tr x-show="book && book.category">
                                            <td><strong>Category</strong></td>
                                            <td x-text="book ? book.category : ''"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Description -->
                            <div x-show="book && book.description" class="mb-4">
                                <p class="has-text-weight-semibold mb-2">Description:</p>
                                <p class="has-text-grey" x-text="book ? book.description : ''"></p>
                            </div>

                            <!-- File Info -->
                            <div class="tags">
                                <span class="tag is-info is-medium" x-show="book">
                                    <span class="icon"><i class="fas fa-file"></i></span>
                                    <span x-text="book ? book.file_format.toUpperCase() : ''"></span>
                                </span>
                                <span class="tag is-light is-medium" x-show="book && book.file_size">
                                    <span class="icon"><i class="fas fa-hdd"></i></span>
                                    <span x-text="book ? formatFileSize(book.file_size) : ''"></span>
                                </span>
                            </div>
                        </div>

                        <!-- Statistics -->
                        <div class="box mb-4">
                            <h4 class="title is-6 mb-3">Statistics</h4>
                            <div class="columns is-mobile">
                                <div class="column has-text-centered">
                                    <p class="heading">Views</p>
                                    <p class="title is-5" x-text="book ? book.view_count : 0"></p>
                                </div>
                                <div class="column has-text-centered">
                                    <p class="heading">Downloads</p>
                                    <p class="title is-5" x-text="book ? book.download_count : 0"></p>
                                </div>
                            </div>
                            <div class="is-size-7 has-text-grey-light mt-3">
                                <p><strong>Uploaded:</strong> <span x-text="book ? formatDate(book.created_at) : ''"></span></p>
                                <p x-show="book && book.uploader_name"><strong>By:</strong> <span x-text="book ? book.uploader_name : ''"></span></p>
                            </div>
                        </div>

                        <!-- Download Button -->
                        <div class="box has-background-success-light mb-4">
                            <button @click="downloadBook" class="button is-success is-fullwidth is-medium" :class="{'is-loading': downloading}" :disabled="downloading">
                                <span class="icon"><i class="fas fa-download"></i></span>
                                <span>Download Book</span>
                            </button>
                        </div>

                        <!-- Admin Actions -->
                        <div x-show="isAdmin" class="box mb-4">
                            <h4 class="title is-6 mb-3">Admin Actions</h4>
                            <div class="buttons">
                                <button @click="openEditModal" class="button is-info is-fullwidth">
                                    <span class="icon"><i class="fas fa-edit"></i></span>
                                    <span>Edit Metadata</span>
                                </button>
                                <button @click="confirmDelete" class="button is-danger is-fullwidth">
                                    <span class="icon"><i class="fas fa-trash"></i></span>
                                    <span>Delete Book</span>
                                </button>
                            </div>
                        </div>

                        <!-- Linked Physical Books -->
                        <div class="box">
                            <div class="level mb-3">
                                <div class="level-left">
                                    <div class="level-item">
                                        <h4 class="title is-6">Linked Physical Books</h4>
                                    </div>
                                </div>
                                <div class="level-right" x-show="isAdmin">
                                    <div class="level-item">
                                        <button @click="openLinkModal" class="button is-small is-success">
                                            <span class="icon is-small"><i class="fas fa-link"></i></span>
                                            <span>Link Book</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Linked Books Table -->
                            <div x-show="linkedBooks.length > 0">
                                <table class="table is-fullwidth is-striped is-hoverable">
                                    <thead>
                                        <tr>
                                            <th>ACC No</th>
                                            <th>Title</th>
                                            <th>Location</th>
                                            <th x-show="isAdmin">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <template x-for="link in linkedBooks" :key="link.book_id">
                                            <tr>
                                                <td><span class="tag is-info" x-text="link.acc_no"></span></td>
                                                <td x-text="link.title"></td>
                                                <td><span class="tag is-light" x-text="link.storage_loc"></span></td>
                                                <td x-show="isAdmin">
                                                    <button @click="removeLink(link.link_id)" class="button is-small is-danger is-outlined">
                                                        <span class="icon is-small"><i class="fas fa-unlink"></i></span>
                                                    </button>
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Empty State -->
                            <div x-show="linkedBooks.length === 0" class="has-text-centered has-text-grey-light py-4">
                                <span class="icon">
                                    <i class="fas fa-unlink"></i>
                                </span>
                                <p>No physical books linked</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Edit Metadata Modal -->
    <div class="modal" :class="{'is-active': showEditModal}" x-cloak>
        <div class="modal-background" @click="closeEditModal"></div>
        <div class="modal-card">
            <header class="modal-card-head has-background-info">
                <p class="modal-card-title has-text-white">Edit Book Metadata</p>
                <button class="delete" @click="closeEditModal" aria-label="close"></button>
            </header>
            <section class="modal-card-body">
                <form @submit.prevent="handleUpdate">
                    <div class="field">
                        <label class="label">Title</label>
                        <div class="control">
                            <input x-model="editForm.title" class="input" type="text">
                        </div>
                    </div>
                    <div class="field">
                        <label class="label">Author</label>
                        <div class="control">
                            <input x-model="editForm.author" class="input" type="text">
                        </div>
                    </div>
                    <div class="field">
                        <label class="label">Subject</label>
                        <div class="control">
                            <input x-model="editForm.subject" class="input" type="text">
                        </div>
                    </div>
                    <div class="field">
                        <label class="label">Publisher</label>
                        <div class="control">
                            <input x-model="editForm.publisher" class="input" type="text">
                        </div>
                    </div>
                    <div class="field">
                        <label class="label">Publication Year</label>
                        <div class="control">
                            <input x-model="editForm.publication_year" class="input" type="number">
                        </div>
                    </div>
                    <div class="field">
                        <label class="label">ISBN</label>
                        <div class="control">
                            <input x-model="editForm.isbn" class="input" type="text">
                        </div>
                    </div>
                </form>
            </section>
            <footer class="modal-card-foot">
                <button @click="handleUpdate" class="button is-info" :class="{'is-loading': updating}">Save Changes</button>
                <button @click="closeEditModal" class="button">Cancel</button>
            </footer>
        </div>
    </div>

    <!-- Link Physical Book Modal -->
    <div class="modal" :class="{'is-active': showLinkModal}" x-cloak>
        <div class="modal-background" @click="closeLinkModal"></div>
        <div class="modal-card">
            <header class="modal-card-head has-background-success">
                <p class="modal-card-title has-text-white">Link Physical Book</p>
                <button class="delete" @click="closeLinkModal" aria-label="close"></button>
            </header>
            <section class="modal-card-body">
                <!-- Search Physical Books -->
                <div class="field">
                    <label class="label">Search Physical Book</label>
                    <div class="control has-icons-left">
                        <input 
                            x-model="physicalBookSearch" 
                            @input="searchPhysicalBooks"
                            class="input" 
                            type="text" 
                            placeholder="Search by Title, Author, or Accession Number..."
                        >
                        <span class="icon is-left">
                            <i class="fas fa-search"></i>
                        </span>
                    </div>
                </div>

                <!-- Search Results -->
                <div x-show="physicalBookResults.length > 0" class="box" style="max-height: 300px; overflow-y: auto;">
                    <template x-for="physicalBook in physicalBookResults" :key="physicalBook.id">
                        <div class="box is-clickable mb-2" @click="selectPhysicalBook(physicalBook)" style="padding: 0.75rem;">
                            <div class="level is-mobile">
                                <div class="level-left">
                                    <div class="level-item">
                                        <div>
                                            <p class="has-text-weight-semibold" x-text="physicalBook.title"></p>
                                            <p class="is-size-7 has-text-grey">
                                                <span class="tag is-info is-small" x-text="physicalBook.acc_no"></span>
                                                <span x-text="physicalBook.author"></span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Selected Book -->
                <div x-show="selectedPhysicalBook" class="box has-background-success-light mt-3">
                    <p class="has-text-weight-semibold mb-2">Selected:</p>
                    <p><strong>ACC No:</strong> <span x-text="selectedPhysicalBook ? selectedPhysicalBook.acc_no : ''"></span></p>
                    <p><strong>Title:</strong> <span x-text="selectedPhysicalBook ? selectedPhysicalBook.title : ''"></span></p>
                    
                    <!-- Link Type -->
                    <div class="field mt-3">
                        <label class="label">Link Type</label>
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select x-model="linkType">
                                    <option value="same_edition">Same Edition</option>
                                    <option value="different_edition">Different Edition</option>
                                    <option value="related">Related Material</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div x-show="linkError" class="notification is-danger is-light mt-3">
                    <button class="delete" @click="linkError = ''"></button>
                    <span x-text="linkError"></span>
                </div>
            </section>
            <footer class="modal-card-foot">
                <button @click="createLink" class="button is-success" :class="{'is-loading': linking}" :disabled="!selectedPhysicalBook || linking">
                    Link Book
                </button>
                <button @click="closeLinkModal" class="button">Cancel</button>
            </footer>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" :class="{'is-active': showDeleteModal}" x-cloak>
        <div class="modal-background" @click="showDeleteModal = false"></div>
        <div class="modal-card">
            <header class="modal-card-head has-background-danger">
                <p class="modal-card-title has-text-white">Confirm Delete</p>
                <button class="delete" @click="showDeleteModal = false" aria-label="close"></button>
            </header>
            <section class="modal-card-body">
                <p class="has-text-danger has-text-weight-semibold mb-3">⚠️ Warning: This action cannot be undone!</p>
                <p>Are you sure you want to delete this digital book?</p>
                <p class="mt-3"><strong>Title:</strong> <span x-text="book ? book.title : ''"></span></p>
                <p class="has-text-grey is-size-7 mt-3">This will permanently delete the file and all associated metadata.</p>
            </section>
            <footer class="modal-card-foot">
                <button @click="handleDelete" class="button is-danger" :class="{'is-loading': deleting}">Yes, Delete</button>
                <button @click="showDeleteModal = false" class="button">Cancel</button>
            </footer>
        </div>
    </div>
</div>

<script>
    function digitalLibraryDetailApp() {
        return {
            book: null,
            linkedBooks: [],
            loading: true,
            error: false,
            isAdmin: false,
            userName: '',
            isFullscreen: false,
            showEditModal: false,
            showLinkModal: false,
            showDeleteModal: false,
            updating: false,
            linking: false,
            deleting: false,
            downloading: false,
            linkError: '',
            editForm: {},
            physicalBookSearch: '',
            physicalBookResults: [],
            selectedPhysicalBook: null,
            linkType: 'same_edition',
            searchTimeout: null,

            async init() {
                // Check if user is logged in
                const token = localStorage.getItem('access_token');
                const userRole = localStorage.getItem('user_role');
                this.isAdmin = token && (userRole === 'admin' || userRole === 'librarian');
                this.userName = localStorage.getItem('full_name') || localStorage.getItem('username') || 'User';
                
                const bookId = this.getBookIdFromUrl();
                if (bookId) {
                    await this.loadBook(bookId);
                }
                
                // Listen for fullscreen changes
                document.addEventListener('fullscreenchange', () => {
                    this.isFullscreen = !!document.fullscreenElement;
                });
                document.addEventListener('webkitfullscreenchange', () => {
                    this.isFullscreen = !!document.webkitFullscreenElement;
                });
            },

            getBookIdFromUrl() {
                const pathParts = window.location.pathname.split('/');
                return pathParts[pathParts.length - 1];
            },

            async loadBook(bookId) {
                this.loading = true;
                const token = localStorage.getItem('access_token');

                try {
                    const headers = {};
                    if (token) {
                        headers['Authorization'] = `Bearer ${token}`;
                    }
                    
                    const response = await fetch(`/api/digital-library/${bookId}`, { headers });

                    if (response.ok) {
                        const data = await response.json();
                        this.book = data;
                        this.linkedBooks = data.linked_physical_books || [];
                    } else if (response.status === 404) {
                        this.error = true;
                        window.toast.error('Digital book not found');
                    } else {
                        this.error = true;
                        window.toast.error('Failed to load book details');
                    }
                } catch (error) {
                    console.error('Error loading book:', error);
                    this.error = true;
                    window.toast.error('Network error while loading book');
                } finally {
                    this.loading = false;
                }
            },

            getPdfViewerUrl() {
                if (!this.book) return '';
                const token = localStorage.getItem('access_token');
                // If token exists, append it; otherwise, public access
                if (token) {
                    return `/api/digital-library/${this.book.id}/view?token=${encodeURIComponent(token)}`;
                } else {
                    return `/api/digital-library/${this.book.id}/view`;
                }
            },

            downloadBook() {
                if (!this.book || this.downloading) return;
                
                // Prevent double-click
                this.downloading = true;
                
                const token = localStorage.getItem('access_token');
                // If token exists, append it; otherwise, public access
                let url = `/api/digital-library/${this.book.id}/download`;
                if (token) {
                    url += `?token=${encodeURIComponent(token)}`;
                }
                window.open(url, '_blank');
                
                // Reset after 2 seconds
                setTimeout(() => {
                    this.downloading = false;
                }, 2000);
            },

            toggleFullscreen() {
                const container = document.getElementById('pdf-viewer-container');
                
                if (!document.fullscreenElement) {
                    // Enter fullscreen
                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    } else if (container.webkitRequestFullscreen) { // Safari
                        container.webkitRequestFullscreen();
                    } else if (container.msRequestFullscreen) { // IE11
                        container.msRequestFullscreen();
                    }
                    this.isFullscreen = true;
                } else {
                    // Exit fullscreen
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) { // Safari
                        document.webkitExitFullscreen();
                    } else if (document.msExitFullscreen) { // IE11
                        document.msExitFullscreen();
                    }
                    this.isFullscreen = false;
                }
            },

            formatFileSize(bytes) {
                if (!bytes) return 'Unknown';
                const mb = bytes / (1024 * 1024);
                return mb < 1 ? `${(bytes / 1024).toFixed(1)} KB` : `${mb.toFixed(1)} MB`;
            },

            formatDate(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
            },

            openEditModal() {
                this.editForm = { ...this.book };
                this.showEditModal = true;
            },

            closeEditModal() {
                this.showEditModal = false;
            },

            async handleUpdate() {
                this.updating = true;
                const token = localStorage.getItem('access_token');
                const formData = new FormData();

                Object.keys(this.editForm).forEach(key => {
                    if (this.editForm[key] !== null && this.editForm[key] !== undefined) {
                        formData.append(key, this.editForm[key]);
                    }
                });

                try {
                    const response = await fetch(`/api/digital-library/${this.book.id}`, {
                        method: 'PUT',
                        headers: { 'Authorization': `Bearer ${token}` },
                        body: formData
                    });

                    if (response.ok) {
                        await this.loadBook(this.book.id);
                        this.showEditModal = false;
                        window.toast.success('Book metadata updated successfully!');
                    } else {
                        const error = await response.json();
                        window.toast.error(error.detail || 'Failed to update book');
                    }
                } catch (error) {
                    console.error('Update error:', error);
                    window.toast.error('Network error. Please try again.');
                } finally {
                    this.updating = false;
                }
            },

            confirmDelete() {
                this.showDeleteModal = true;
            },

            async handleDelete() {
                this.deleting = true;
                const token = localStorage.getItem('access_token');

                try {
                    const response = await fetch(`/api/digital-library/${this.book.id}`, {
                        method: 'DELETE',
                        headers: { 'Authorization': `Bearer ${token}` }
                    });

                    if (response.ok) {
                        window.toast.success('Digital book deleted successfully!');
                        setTimeout(() => {
                            window.location.href = '/digital-library';
                        }, 500);
                    } else {
                        window.toast.error('Failed to delete book');
                        this.showDeleteModal = false;
                    }
                } catch (error) {
                    console.error('Delete error:', error);
                    window.toast.error('Network error. Please try again.');
                    this.showDeleteModal = false;
                } finally {
                    this.deleting = false;
                }
            },

            openLinkModal() {
                this.showLinkModal = true;
                this.physicalBookSearch = '';
                this.physicalBookResults = [];
                this.selectedPhysicalBook = null;
                this.linkType = 'same_edition';
                this.linkError = '';
            },

            closeLinkModal() {
                this.showLinkModal = false;
            },

            searchPhysicalBooks() {
                clearTimeout(this.searchTimeout);
                this.searchTimeout = setTimeout(async () => {
                    if (this.physicalBookSearch.length < 2) {
                        this.physicalBookResults = [];
                        return;
                    }

                    const token = localStorage.getItem('access_token');
                    try {
                        const response = await fetch(`/api/books?search=${encodeURIComponent(this.physicalBookSearch)}&limit=10`, {
                            headers: { 'Authorization': `Bearer ${token}` }
                        });

                        if (response.ok) {
                            this.physicalBookResults = await response.json();
                        }
                    } catch (error) {
                        console.error('Search error:', error);
                    }
                }, 300);
            },

            selectPhysicalBook(book) {
                this.selectedPhysicalBook = book;
                this.physicalBookResults = [];
                this.physicalBookSearch = '';
            },

            async createLink() {
                if (!this.selectedPhysicalBook) return;

                this.linking = true;
                this.linkError = '';
                const token = localStorage.getItem('access_token');

                try {
                    const response = await fetch('/api/digital-library/links', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            book_id: this.selectedPhysicalBook.id,
                            digital_book_id: this.book.id,
                            link_type: this.linkType
                        })
                    });

                    if (response.ok) {
                        await this.loadBook(this.book.id);
                        this.closeLinkModal();
                        window.toast.success('Physical book linked successfully!');
                    } else {
                        const error = await response.json();
                        this.linkError = error.detail || 'Failed to create link';
                        window.toast.error(this.linkError);
                    }
                } catch (error) {
                    console.error('Link error:', error);
                    this.linkError = 'Network error. Please try again.';
                    window.toast.error('Network error. Please try again.');
                } finally {
                    this.linking = false;
                }
            },

            async removeLink(linkId) {
                if (!confirm('Remove this link?')) return;

                const token = localStorage.getItem('access_token');
                try {
                    const response = await fetch(`/api/digital-library/links/${linkId}`, {
                        method: 'DELETE',
                        headers: { 'Authorization': `Bearer ${token}` }
                    });

                    if (response.ok) {
                        await this.loadBook(this.book.id);
                        window.toast.success('Link removed successfully!');
                    } else {
                        window.toast.error('Failed to remove link');
                    }
                } catch (error) {
                    console.error('Remove link error:', error);
                    window.toast.error('Network error. Please try again.');
                }
            },

            logout() {
                localStorage.removeItem('access_token');
                localStorage.removeItem('user_role');
                localStorage.removeItem('user_id');
                localStorage.removeItem('username');
                localStorage.removeItem('full_name');
                window.location.href = '/';
            },

            openChangePasswordModal() {
                window.openChangePasswordModal();
            }
        }
    }
</script>

<style>
    [x-cloak] { display: none !important; }
    
    .pdf-fullscreen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9999;
        background-color: #525659;
    }

    .is-clickable {
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .is-clickable:hover {
        background-color: #f0f0f0;
        transform: translateY(-2px);
    }
</style>

<!-- Include Change Password Modal -->
{% include 'change_password_modal.html' %}

{% endblock %}
